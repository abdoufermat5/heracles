# =============================================================================
# Postfix LDAP Lookup - Virtual Alias Maps
# =============================================================================
# Maps alternate email addresses (aliases) to primary addresses.
# Queries LDAP for hrcMailAlternateAddress â†’ mail mapping.
#
# Template variables: @LDAP_HOST@, @LDAP_PORT@, @LDAP_BIND_DN@,
#                     @LDAP_BIND_PASSWORD@, @MAIL_LDAP_SEARCH_BASE@
# =============================================================================

server_host = ldaps://@LDAP_HOST@:@LDAP_PORT@
version = 3
tls_ca_cert_file = @LDAP_CA_CERT@
tls_reqcert = hard

bind = yes
bind_dn = @LDAP_BIND_DN@
bind_pw = @LDAP_BIND_PASSWORD@

search_base = @MAIL_LDAP_SEARCH_BASE@

# Find users whose alternate address matches
query_filter = (&(objectClass=hrcMailAccount)(hrcMailAlternateAddress=%s))

# Return the primary mail address
result_attribute = mail
