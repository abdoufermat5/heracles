{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "POSIX Group",
  "description": "Schema for POSIX/Unix group management",
  "type": "object",
  "properties": {
    "cn": {
      "type": "string",
      "title": "Group Name",
      "description": "Unique identifier for the group",
      "minLength": 1,
      "maxLength": 64,
      "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
      "ui:placeholder": "developers",
      "ui:autofocus": true
    },
    "gidNumber": {
      "type": "integer",
      "title": "GID Number",
      "description": "Unix group ID (auto-allocated if empty)",
      "minimum": 1000,
      "maximum": 65534,
      "ui:placeholder": "Auto",
      "ui:readonlyAfterCreate": true
    },
    "forceGid": {
      "type": "boolean",
      "title": "Force GID",
      "description": "Force use of specific GID even if it appears allocated",
      "default": false
    },
    "description": {
      "type": "string",
      "title": "Description",
      "description": "Human-readable description of the group",
      "maxLength": 255,
      "ui:widget": "textarea",
      "ui:placeholder": "Development team members"
    },
    "memberUid": {
      "type": "array",
      "title": "Unix Members",
      "description": "Users who are members of this Unix group (by uid)",
      "items": {
        "type": "string"
      },
      "ui:widget": "user-select",
      "ui:filter": "(objectClass=posixAccount)",
      "ui:displayField": "uid",
      "ui:valueField": "uid",
      "ui:placeholder": "Select users to add as Unix group members"
    },
    "trustMode": {
      "type": "string",
      "title": "Trust Mode",
      "description": "Control which systems this group is available on",
      "enum": [null, "fullaccess", "byhost"],
      "ui:widget": "select",
      "ui:enumNames": ["No restriction", "Available on all systems", "Restricted to specific hosts"],
      "ui:section": "trust"
    },
    "host": {
      "type": "array",
      "title": "Allowed Hosts",
      "description": "Systems where this group is available",
      "items": {
        "type": "string"
      },
      "ui:widget": "host-select",
      "ui:filter": "(objectClass=ipHost)",
      "ui:displayField": "cn",
      "ui:valueField": "cn",
      "ui:visibleWhen": {
        "field": "trustMode",
        "equals": "byhost"
      },
      "ui:section": "trust"
    }
  },
  "required": ["cn"],
  "ui:order": ["cn", "gidNumber", "forceGid", "description", "memberUid", "trustMode", "host"],
  "ui:sections": {
    "main": {
      "title": "Group Settings",
      "fields": ["cn", "gidNumber", "forceGid", "description"]
    },
    "members": {
      "title": "POSIX Members",
      "fields": ["memberUid"]
    },
    "trust": {
      "title": "System Trust",
      "collapsed": true,
      "fields": ["trustMode", "host"]
    }
  }
}
