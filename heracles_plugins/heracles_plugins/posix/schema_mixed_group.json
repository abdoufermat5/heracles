{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Mixed Group",
  "description": "Schema for combined LDAP (groupOfNames) and POSIX (posixGroup) group management",
  "type": "object",
  "properties": {
    "cn": {
      "type": "string",
      "title": "Group Name",
      "description": "Unique identifier for the group",
      "minLength": 1,
      "maxLength": 64,
      "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
      "ui:placeholder": "developers",
      "ui:autofocus": true
    },
    "gidNumber": {
      "type": "integer",
      "title": "GID Number",
      "description": "Unix group ID (auto-allocated if empty)",
      "minimum": 1000,
      "maximum": 65534,
      "ui:placeholder": "Auto",
      "ui:readonlyAfterCreate": true
    },
    "description": {
      "type": "string",
      "title": "Description",
      "description": "Human-readable description of the group",
      "maxLength": 255,
      "ui:widget": "textarea",
      "ui:placeholder": "Development team members"
    },
    "member": {
      "type": "array",
      "title": "LDAP Members",
      "description": "Members identified by Distinguished Name (for LDAP-based access control)",
      "items": {
        "type": "string"
      },
      "ui:widget": "dn-select",
      "ui:filter": "(objectClass=inetOrgPerson)",
      "ui:displayField": "cn",
      "ui:valueField": "dn",
      "ui:placeholder": "Select members for LDAP group-based access control (ACLs, application permissions)"
    },
    "memberUid": {
      "type": "array",
      "title": "Unix Members",
      "description": "Members identified by uid (for Unix/POSIX permissions)",
      "items": {
        "type": "string"
      },
      "ui:widget": "user-select",
      "ui:filter": "(objectClass=posixAccount)",
      "ui:displayField": "uid",
      "ui:valueField": "uid",
      "ui:placeholder": "Select users for Unix file permissions and NFS access"
    },
    "trustMode": {
      "type": "string",
      "title": "Trust Mode",
      "description": "Control which systems this group is available on",
      "enum": [null, "fullaccess", "byhost"],
      "ui:widget": "select",
      "ui:enumNames": ["No restriction", "Available on all systems", "Restricted to specific hosts"],
      "ui:section": "trust"
    },
    "host": {
      "type": "array",
      "title": "Allowed Hosts",
      "description": "Systems where this group is available",
      "items": {
        "type": "string"
      },
      "ui:widget": "host-select",
      "ui:filter": "(objectClass=ipHost)",
      "ui:displayField": "cn",
      "ui:valueField": "cn",
      "ui:visibleWhen": {
        "field": "trustMode",
        "equals": "byhost"
      },
      "ui:section": "trust"
    }
  },
  "required": ["cn"],
  "ui:order": ["cn", "gidNumber", "description", "member", "memberUid", "trustMode", "host"],
  "ui:sections": {
    "main": {
      "title": "Group Settings",
      "fields": ["cn", "gidNumber", "description"]
    },
    "ldap_members": {
      "title": "LDAP Members (groupOfNames)",
      "description": "Members identified by their full LDAP Distinguished Name",
      "fields": ["member"]
    },
    "posix_members": {
      "title": "POSIX Members (memberUid)",
      "description": "Members identified by their Unix uid attribute",
      "fields": ["memberUid"]
    },
    "trust": {
      "title": "System Trust",
      "collapsed": true,
      "fields": ["trustMode", "host"]
    }
  }
}
