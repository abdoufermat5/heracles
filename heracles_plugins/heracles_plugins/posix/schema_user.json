{
  "$schema": "https://heracles.example.com/schemas/form-schema-v1.json",
  "id": "posix",
  "version": "1.0.0",
  "title": "Unix Account",
  "description": "POSIX/Unix account settings for Linux/Unix systems",
  "icon": "terminal",

  "activation": {
    "label": "Enable Unix account",
    "description": "Add POSIX attributes to enable Unix/Linux system access"
  },

  "sections": [
    {
      "id": "main",
      "title": "Account Settings",
      "description": "Core POSIX account configuration",
      "fields": [
        {
          "name": "uidNumber",
          "type": "number",
          "label": "UID Number",
          "description": "Unix user ID (auto-allocated if empty)",
          "required": false,
          "readonlyAfterCreate": true,
          "min": 1000,
          "max": 65534,
          "placeholder": "Auto",
          "helpText": "Leave empty to auto-allocate the next available UID"
        },
        {
          "name": "gidNumber",
          "type": "group_select",
          "label": "Primary Group",
          "description": "Primary Unix group for this user",
          "required": true,
          "filter": "(objectClass=posixGroup)",
          "displayField": "cn",
          "valueField": "gidNumber",
          "helpText": "Select the user's primary Unix group"
        },
        {
          "name": "homeDirectory",
          "type": "string",
          "label": "Home Directory",
          "description": "User's home directory path",
          "required": true,
          "pattern": "^/[\\w./-]+$",
          "defaultTemplate": "/home/{uid}",
          "placeholder": "/home/username",
          "helpText": "Leave empty to auto-generate from username"
        },
        {
          "name": "loginShell",
          "type": "select",
          "label": "Login Shell",
          "description": "Default shell when user logs in",
          "required": false,
          "default": "/bin/bash",
          "options": [
            {"value": "/bin/bash", "label": "Bash"},
            {"value": "/bin/zsh", "label": "Zsh"},
            {"value": "/bin/sh", "label": "Sh"},
            {"value": "/bin/fish", "label": "Fish"},
            {"value": "/usr/sbin/nologin", "label": "No Login"},
            {"value": "/bin/false", "label": "False (disabled)"}
          ]
        }
      ]
    },
    {
      "id": "gecos",
      "title": "Additional Info",
      "collapsed": true,
      "fields": [
        {
          "name": "gecos",
          "type": "string",
          "label": "GECOS",
          "description": "General information field (typically full name)",
          "required": false,
          "defaultTemplate": "{cn}",
          "placeholder": "Full Name",
          "helpText": "Leave empty to use the user's display name"
        }
      ]
    },
    {
      "id": "shadow",
      "title": "Password Policy",
      "description": "Shadow account settings for password expiration",
      "collapsed": true,
      "fields": [
        {
          "name": "shadowMin",
          "type": "number",
          "label": "Minimum Days Between Changes",
          "description": "Minimum days before password can be changed",
          "required": false,
          "min": 0,
          "placeholder": "0",
          "helpText": "User cannot change password until this many days pass"
        },
        {
          "name": "shadowMax",
          "type": "number",
          "label": "Maximum Password Age (Days)",
          "description": "Maximum days password is valid",
          "required": false,
          "min": 0,
          "default": 99999,
          "placeholder": "99999",
          "helpText": "Password must be changed after this many days"
        },
        {
          "name": "shadowWarning",
          "type": "number",
          "label": "Warning Days Before Expiry",
          "description": "Days before expiry to start warning user",
          "required": false,
          "min": 0,
          "default": 7,
          "placeholder": "7",
          "helpText": "User will be warned this many days before password expires"
        },
        {
          "name": "shadowInactive",
          "type": "number",
          "label": "Inactive Days After Expiry",
          "description": "Days after expiry before account is disabled",
          "required": false,
          "min": -1,
          "placeholder": "-1",
          "helpText": "-1 means never disable, 0 disables immediately on expiry"
        },
        {
          "name": "shadowExpire",
          "type": "date",
          "label": "Account Expiration Date",
          "description": "Date when account expires",
          "required": false,
          "format": "epoch-days",
          "helpText": "Leave empty for no expiration"
        }
      ]
    }
  ],

  "validation": {
    "rules": [
      {
        "type": "unique",
        "field": "uidNumber",
        "scope": "global",
        "message": "This UID is already in use"
      },
      {
        "type": "dependency",
        "field": "shadowWarning",
        "dependsOn": "shadowMax",
        "message": "Warning days requires maximum password age to be set"
      },
      {
        "type": "comparison",
        "field": "shadowMin",
        "operator": "lte",
        "compareTo": "shadowMax",
        "message": "Minimum days cannot exceed maximum days"
      }
    ]
  }
}
