{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "POSIX Account",
  "description": "Schema for POSIX/Unix account settings on users",
  "type": "object",
  "properties": {
    "uidNumber": {
      "type": "integer",
      "title": "UID Number",
      "description": "Unix user ID (auto-allocated if empty)",
      "minimum": 1000,
      "maximum": 65534,
      "ui:placeholder": "Auto",
      "ui:readonlyAfterCreate": true
    },
    "gidNumber": {
      "type": "integer",
      "title": "Primary Group",
      "description": "Primary Unix group for this user",
      "minimum": 1000,
      "maximum": 65534,
      "ui:widget": "group-select",
      "ui:filter": "(objectClass=posixGroup)",
      "ui:displayField": "cn",
      "ui:valueField": "gidNumber"
    },
    "homeDirectory": {
      "type": "string",
      "title": "Home Directory",
      "description": "User's home directory path",
      "pattern": "^/[\\w./-]+$",
      "ui:placeholder": "/home/username",
      "ui:defaultTemplate": "/home/{uid}"
    },
    "loginShell": {
      "type": "string",
      "title": "Login Shell",
      "description": "Default shell when user logs in",
      "enum": [
        "/bin/bash",
        "/bin/zsh",
        "/bin/sh",
        "/bin/fish",
        "/usr/sbin/nologin",
        "/bin/false"
      ],
      "default": "/bin/bash",
      "ui:widget": "select",
      "ui:enumNames": ["Bash", "Zsh", "Sh", "Fish", "No Login", "False (disabled)"]
    },
    "gecos": {
      "type": "string",
      "title": "GECOS",
      "description": "General information field (typically full name)",
      "ui:placeholder": "Full Name",
      "ui:defaultTemplate": "{cn}"
    },
    "shadowMin": {
      "type": "integer",
      "title": "Minimum Days Between Changes",
      "description": "Minimum days before password can be changed",
      "minimum": 0,
      "ui:placeholder": "0",
      "ui:section": "shadow"
    },
    "shadowMax": {
      "type": "integer",
      "title": "Maximum Password Age (Days)",
      "description": "Maximum days password is valid",
      "minimum": 0,
      "default": 99999,
      "ui:placeholder": "99999",
      "ui:section": "shadow"
    },
    "shadowWarning": {
      "type": "integer",
      "title": "Warning Days Before Expiry",
      "description": "Days before expiry to start warning user",
      "minimum": 0,
      "default": 7,
      "ui:placeholder": "7",
      "ui:section": "shadow"
    },
    "shadowInactive": {
      "type": "integer",
      "title": "Inactive Days After Expiry",
      "description": "Days after expiry before account is disabled (-1 = never, 0 = immediately)",
      "minimum": -1,
      "ui:placeholder": "-1",
      "ui:section": "shadow"
    },
    "shadowExpire": {
      "type": "integer",
      "title": "Account Expiration Date",
      "description": "Date when account expires (epoch days)",
      "ui:widget": "date",
      "ui:format": "epoch-days",
      "ui:section": "shadow"
    },
    "trustMode": {
      "type": "string",
      "title": "Trust Mode",
      "description": "Control which systems this account can access",
      "enum": [null, "fullaccess", "byhost"],
      "ui:widget": "select",
      "ui:enumNames": ["No restriction", "Available on all systems", "Restricted to specific hosts"],
      "ui:section": "trust"
    },
    "host": {
      "type": "array",
      "title": "Allowed Hosts",
      "description": "Systems where this account can login",
      "items": {
        "type": "string"
      },
      "ui:widget": "host-select",
      "ui:filter": "(objectClass=ipHost)",
      "ui:displayField": "cn",
      "ui:valueField": "cn",
      "ui:visibleWhen": {
        "field": "trustMode",
        "equals": "byhost"
      },
      "ui:section": "trust"
    }
  },
  "required": ["gidNumber", "homeDirectory"],
  "ui:order": [
    "uidNumber",
    "gidNumber",
    "homeDirectory",
    "loginShell",
    "gecos",
    "shadowMin",
    "shadowMax",
    "shadowWarning",
    "shadowInactive",
    "shadowExpire",
    "trustMode",
    "host"
  ],
  "ui:sections": {
    "main": {
      "title": "Account Settings",
      "fields": ["uidNumber", "gidNumber", "homeDirectory", "loginShell"]
    },
    "gecos": {
      "title": "Additional Info",
      "collapsed": true,
      "fields": ["gecos"]
    },
    "shadow": {
      "title": "Password Policy",
      "collapsed": true,
      "fields": ["shadowMin", "shadowMax", "shadowWarning", "shadowInactive", "shadowExpire"]
    },
    "trust": {
      "title": "System Trust",
      "collapsed": true,
      "fields": ["trustMode", "host"]
    }
  }
}
